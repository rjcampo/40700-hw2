---
title: "MACS 40700 HW 2"
author: "Richard Campo"
date: "`r Sys.Date()`"
output: github_output
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
rm(list = ls())
setwd("C:/Users/RichardCampo/Documents/GitHub/40700-hw2")
options(rstudio.help.showDataPreview = FALSE)
```

#Part 1: Portfolio 1 Proposal

I will use the "Trust and Democratic Governance" data set from the Organization for Economic Cooperation and Development (OECD), available [here](https://data-explorer.oecd.org/vis?lc=en&fs[0]=Topic%2C1%7CGovernment%23GOV%23%7CGeneral%20government%23GOV_GG%23&pg=0&fc=Topic&bp=true&snb=14&vw=ov&df[ds]=dsDisseminateFinalDMZ&df[id]=DSD_GOV_TDG_SPS_GPC%40DF_GOV_TDG_2023&df[ag]=OECD.GOV.GIP&df[vs]=1.0&pd=%2C&dq=A.......&ly[rw]=REF_AREA&ly[cl]=MEASURE%2CSCALE&to[TIME_PERIOD]=false&lo=5&lom=LASTNPERIODS).

My tentative research question is: "Trust in what levels and branches of government has the strongest association with perceived political efficacy, defined as 'having a say in what the government does?'"


## Data Cleaning
```{r, warning=FALSE, message=FALSE}
library(tidyverse)

oecd_data <- read_csv("OECD governance data.csv")
glimpse(oecd_data)
```
```{r}
oecd_data <- oecd_data %>%
  filter(REF_AREA != "OECD_REP")

oecd_data <- oecd_data %>% 
  select(`Reference area`, MEASURE, SCALE, OBS_VALUE)

col_names <- c(country = "Reference area", measure = "MEASURE",
               scale = "SCALE", percentage = "OBS_VALUE")

oecd_data <- rename(oecd_data, all_of(col_names))

oecd_data <- oecd_data %>% 
  pivot_wider(names_from = c(measure, scale), values_from = percentage)
```

```{r, warning = FALSE}
colnames(oecd_data)

ggplot(oecd_data, aes(x = TRUST_CS_HMH, y = TRUST_PE_EXT_CON)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(
    title = "Trust in civil service vs. perceived political efficacy", 
    x = "Trust in the civil service",
    y = "Political efficacy")
```

```{r, warning = FALSE}
ggplot(oecd_data, aes(x = TRUST_LE_HMH, y = TRUST_PE_EXT_CON)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(
    title = "Trust in legislature vs. perceived political efficacy", 
    x = "Trust in legislature",
    y = "Political efficacy")
```

```{r, warning = FALSE}
ggplot(oecd_data, aes(x = TRUST_CL_HMH, y = TRUST_PE_EXT_CON)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(
    title = "Trust in courts vs. perceived political efficacy", 
    x = "Trust in courts",
    y = "Political efficacy")
```

```{r}
trust_vars <- c("TRUST_CS_HMH", "TRUST_LE_HMH", "TRUST_CL_HMH")

for (var in trust_vars) {
  plot_title <- switch(
    var,
    "TRUST_CS_HMH" = "Trust in civil service vs. perceived political efficacy",
    "TRUST_LE_HMH" = "Trust in legislature vs. perceived political efficacy",
    "TRUST_CL_HMH" = "Trust in courts vs. perceived political efficacy"
  )
  # .data[[]] converts the string to the column name
  print(ggplot(
    oecd_data, aes(x = .data[[var]], y = TRUST_PE_EXT_CON)) +
    geom_point() +
    geom_smooth(method = "lm", se = FALSE) +
    labs(
      title = plot_title,
      x = paste("Trust in", tools::toTitleCase(gsub("_", " ", var))),
      y = "Political efficacy"
    )
    )
}
```


